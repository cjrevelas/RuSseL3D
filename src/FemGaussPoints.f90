!RuSseL3D - Copyright (C) 2021 C. J. Revelas, A. P. Sgouros, A. T. Lakkas
!
!See the LICENSE file in the root directory for license information.

subroutine FemGaussPoints(kk, lint, s)
!--------------------------------------------------------------------!
implicit  none
!--------------------------------------------------------------------!
integer, intent(in)  :: kk
integer, intent(out) :: lint
integer              :: ii, jj

real(8), intent(out), dimension(5,*) :: s
!--------------------------------------------------------------------!
! 1 pt. quadrature O(h^2)
if (kk.eq.1) then
  lint = 1

  do ii = 1, 4
    s(ii,1) = 0.25d0
  enddo

  s(5,1) = 1.0d0/6.0d0

! 4 pt. quadrature O(h^3)
elseif (kk.eq.2) then
  lint = 4

  s(5,4) = 0.25d0/6.0d0

  do ii = 1, 4
    do jj = 1, 4
      s(ii,jj) = 0.1381966011250105d0
    enddo
    s(ii,ii) = 0.5854101966249658d0
    s(5,ii) = s(5,4)
  enddo

! 11 pt. quadrature O(h^4)
elseif (kk.eq.3) then
  lint = 11

  do ii = 1, 3
    do jj = 1, 10
      s(ii,jj) = 0.0d0
    enddo
    s(ii, ii  ) = 1.0d0
    s(ii, ii+4) = 0.5d0
    s(ii, ii+7) = 0.5d0
    s(ii, 11 ) = 0.25d0
  enddo

  s(2, 5) = 0.5d0
  s(3, 6) = 0.5d0
  s(1,10) = 0.5d0

  do jj = 1, 4
    s(5,jj) = 1.0d0/360.0d0
  enddo

  do jj = 5, 10
    s(5,jj) = 1.0d0/90.0d0
  enddo

  s(5,11) = 4.0d0/45.0d0
  s(1, 7) = 0.5d0
  s(1,10) = 0.0d0

! 16 pt. quadrature O(h^5)
else
  lint = 16

  s(5,4) = 0.8395632516687135d-02

  do ii = 1, 3
    do jj = 1, 4
      s(ii,jj) = 0.7611903264425430d-01
    enddo
    s(ii,ii) = 0.7716429020672371d0
    s(5,ii) = s(5,4)
  enddo

  do ii = 5, 16
    s(5,ii) = 0.1109034477221540d-01
  enddo

  s(1, 5) = 0.1197005277978019d0
  s(2, 5) = 0.7183164526766925d-01
  s(3, 5) = 0.4042339134672644d0
  s(1, 6) = 0.4042339134672644d0
  s(2, 6) = 0.1197005277978019d0
  s(3, 6) = 0.7183164526766925d-01
  s(1, 7) = 0.4042339134672644d0
  s(2, 7) = 0.4042339134672644d0
  s(3, 7) = 0.1197005277978019d0
  s(1, 8) = 0.7183164526766925d-01
  s(2, 8) = 0.4042339134672644d0
  s(3, 8) = 0.4042339134672644d0

  s(1, 9) = 0.1197005277978019d0
  s(2, 9) = 0.4042339134672644d0
  s(3, 9) = 0.7183164526766925d-01
  s(1,10) = 0.4042339134672644d0
  s(2,10) = 0.1197005277978019d0
  s(3,10) = 0.4042339134672644d0
  s(1,11) = 0.7183164526766925d-01
  s(2,11) = 0.4042339134672644d0
  s(3,11) = 0.1197005277978019d0
  s(1,12) = 0.4042339134672644d0
  s(2,12) = 0.7183164526766925d-01
  s(3,12) = 0.4042339134672644d0

  s(1,13) = 0.1197005277978019d0
  s(2,13) = 0.4042339134672644d0
  s(3,13) = 0.4042339134672644d0
  s(1,14) = 0.7183164526766925d-01
  s(2,14) = 0.1197005277978019d0
  s(3,14) = 0.4042339134672644d0
  s(1,15) = 0.4042339134672644d0
  s(2,15) = 0.7183164526766925d-01
  s(3,15) = 0.1197005277978019d0
  s(1,16) = 0.4042339134672644d0
  s(2,16) = 0.4042339134672644d0
  s(3,16) = 0.7183164526766925d-01
endif

! Compute fourth points
do jj = 1, lint
  s(4,jj) = 1.0d0 - (s(1,jj) + s(2,jj) + s(3,jj))
enddo

return
!--------------------------------------------------------------------!
end subroutine FemGaussPoints
